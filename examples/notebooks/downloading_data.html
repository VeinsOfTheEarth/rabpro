<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Downloading data &mdash; rabpro  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-dropdown.css?v=995e94df" />
      <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.min.css?v=21c0b90a" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=f3cb8367" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Basic example" href="basic_example.html" />
    <link rel="prev" title="Configuration" href="../../configure/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            rabpro
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Setup:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configure/index.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Downloading data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Download-HydroBasins">Download HydroBasins</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Downloading-MERIT-tiles">Downloading MERIT tiles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="basic_example.html">Basic example</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple_basins.html">Multiple basins</a></li>
<li class="toctree-l1"><a class="reference internal" href="basin_stats.html">Basin stats examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellanea:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../issues/index.html">Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references/index.html">Citing rabpro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apiref/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">rabpro</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Downloading data</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Downloading-data">
<h1>Downloading data<a class="headerlink" href="#Downloading-data" title="Link to this heading"></a></h1>
<p>This notebooks demonstrates how to download data needed by rabpro to delineate watersheds and create a flowline elevation profile.</p>
<p>There are two methods available for delineating watersheds:</p>
<ol class="arabic simple">
<li><p>HydroBasins: easier as all the data can be downloaded in one simple call, but the smallest basins are ~230 km^2. Also faster delineations. Useful for large basins.</p></li>
<li><p>MERIT-Hydro: MERIT-Hydro data is provided as 30 degree by 30 degree tiled chunks. See <a class="reference external" href="http://hydro.iis.u-tokyo.ac.jp/~yamadai/MERIT_Hydro/">http://hydro.iis.u-tokyo.ac.jp/~yamadai/MERIT_Hydro/</a>. You must ensure that you download sufficient area to fully cover your target watershed. you must identify the tile(s) needed to download. You must also register at the above site to receive the username and password for downloads. rabpro uses four of the layers provided by MERIT-Hydro: flow directions, adjusted elevations, upstream drainage area, and
river width.</p></li>
</ol>
<section id="Download-HydroBasins">
<h2>Download HydroBasins<a class="headerlink" href="#Download-HydroBasins" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from rabpro import data_utils
data_utils.download_hydrobasins()

# If you are behind a proxy, you can provide the proxy argument, e.g.
# data_utils.download_hydrobasins(proxy=&#39;proxy_address:port&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading HydroBasins zip file (562 MB)...
Unzipping HydroBasins zip file...
Done.
</pre></div></div>
</div>
<p>If the download fails, ensure you’re not behind a proxy. If so, provide the proxy as a keyword argument. If not, often simply retrying the download will work. You may also manually download HydroBasins <a class="reference external" href="https://drive.google.com/file/d/1NLJUEWhJ9A4y47rcGYv_jWF1Tx2nLEO9/view?usp=sharing">here</a>. You will need to place it in the correct directory, which you can find with the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Where will rabpro look for the HydroBasins data?
from rabpro import utils
print(utils.get_datapaths()[&#39;HydroBasins_root&#39;])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
One or more MERIT layers have no data. Use rabro.data_utils.download_merit_hydro() to fetch a MERIT tile.
C:\Users\318596\AppData\Local\rabpro\rabpro\HydroBasins
</pre></div></div>
</div>
<p>Within the HydroBasins directory, there should be two subdirectores: level_one and level_twelve.</p>
</section>
<section id="Downloading-MERIT-tiles">
<h2>Downloading MERIT tiles<a class="headerlink" href="#Downloading-MERIT-tiles" title="Link to this heading"></a></h2>
<p>For demonstration purposes, we will download a fairly sparse MERIT tile that has a relatively small filesize. Let’s say that our watershed falls in the ‘s30e150’ tile. Additionally, the username and password are hidden here–you must first request access at the <a class="reference external" href="http://hydro.iis.u-tokyo.ac.jp/~yamadai/MERIT_Hydro/">MERIT-Hydro page</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from rabpro import data_utils
merit_tile = &#39;s30e150&#39;
username = hidden
password = hidden
data_utils.download_merit_hydro(merit_tile, username, password) # Can also add proxy argument.
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading &#39;http://hydro.iis.u-tokyo.ac.jp/~yamadai/MERIT_Hydro/distribute/v1.0/dir_s30e150.tar&#39; into &#39;C:\Users\318596\AppData\Local\rabpro\rabpro\MERIT_Hydro\MERIT_FDR\dir_s30e150.tar&#39;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|█████████████████████████████████████████████████████████████████████████████| 23.9M/23.9M [00:07&lt;00:00, 3.26MB/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading &#39;http://hydro.iis.u-tokyo.ac.jp/~yamadai/MERIT_Hydro/distribute/v1.0/elv_s30e150.tar&#39; into &#39;C:\Users\318596\AppData\Local\rabpro\rabpro\MERIT_Hydro\MERIT_ELEV_HP\elv_s30e150.tar&#39;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|███████████████████████████████████████████████████████████████████████████████| 169M/169M [00:29&lt;00:00, 5.76MB/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading &#39;http://hydro.iis.u-tokyo.ac.jp/~yamadai/MERIT_Hydro/distribute/v1.0/upa_s30e150.tar&#39; into &#39;C:\Users\318596\AppData\Local\rabpro\rabpro\MERIT_Hydro\MERIT_UDA\upa_s30e150.tar&#39;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|███████████████████████████████████████████████████████████████████████████████| 112M/112M [00:18&lt;00:00, 6.13MB/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading &#39;http://hydro.iis.u-tokyo.ac.jp/~yamadai/MERIT_Hydro/distribute/v1.0/wth_s30e150.tar&#39; into &#39;C:\Users\318596\AppData\Local\rabpro\rabpro\MERIT_Hydro\MERIT_WTH\wth_s30e150.tar&#39;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|█████████████████████████████████████████████████████████████████████████████| 15.3M/15.3M [00:05&lt;00:00, 2.67MB/s]
</pre></div></div>
</div>
<p>rabpro automatically unzips and stores the MERIT-Hydro tiles in the proper locations.</p>
<p>MERIT-Hydro tiles are collections of 5x5 degree geotiffs. rabpro “stitches” these geotiffs together in virtual rasters. Each time you call <code class="docutils literal notranslate"><span class="pre">download_merit_hydro()</span></code>, rabpro will automatically rebuild the virtual rasters to ensure that the new geotiffs are available. We can check that these virtual rasters have been built.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># We can check that the virtual rasters were built
from rabpro import utils
import os
datapaths = utils.get_datapaths()
if os.path.isfile(datapaths[&#39;DEM_fdr&#39;]) is True:
    print(&#39;Flow directions virtual raster was built.&#39;)
if os.path.isfile(datapaths[&#39;DEM_uda&#39;]) is True:
    print(&#39;Drainage area virtual raster was built.&#39;)
if os.path.isfile(datapaths[&#39;DEM_elev_hp&#39;]) is True:
    print(&#39;Elevations virtual raster was built.&#39;)
if os.path.isfile(datapaths[&#39;DEM_width&#39;]) is True:
    print(&#39;Width virtual raster was built.&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Flow directions virtual raster was built.
Drainage area virtual raster was built.
Elevations virtual raster was built.
Width virtual raster was built.
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../configure/index.html" class="btn btn-neutral float-left" title="Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="basic_example.html" class="btn btn-neutral float-right" title="Basic example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, J. Schwenk, J. Stachelek, T. Zussman, &amp; J. Rowland.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>